[["index.html", "An optimized practice for upstream analysis of single nucleus transcriptomics in key metabolic tissues 1 Introduction", " An optimized practice for upstream analysis of single nucleus transcriptomics in key metabolic tissues Pengwei Dong 2024-10-09 1 Introduction This is a benchmarked and optimized workflow for analyzing single-nuclei RNA sequencing (snRNA-seq), tailored to the analysis of metabolically active tissues. This workflow includes key steps from preprocessing to downstream analyses. This technical note aims to serve as a standard protocol for researchers seeking to apply snRNA-seq to metabolic tissues including adipose tissue, muscle, hypothalamus and liver to uncover novel regulatory mechanisms, identify new therapeutic targets, and ultimately contribute to the development of more effective treatments for metabolic disorders. This workflow encompasses a series of procedures, including the alignment and quantification of raw fastq files, followed by the recommended removal of ambient RNA after generating the raw matrix. Additionally, it involves the potential identification and removal of doublets using scDblFinder, normalization of gene expression values, multiple approaches for data integration, and comprehensive benchmarking steps to ensure robust results. "],["genome-alignment-and-quanyification.html", "2 Genome alignment and quanyification", " 2 Genome alignment and quanyification Raw single nucleus transcriptomics sequencing reads in fastq format were downloaded and processed with Cellranger (version 7.1.0, 10x Genomics) with enabled intron mode for each sample, the reads were aligned to the human GRCh38 genome-2020-A and mouse samples to mm10-3.0.0 genome to generate unique molecular identifiers (UMI) the expression matrices.The command we use were as follows: "],["ambient-rna-removal.html", "3 Ambient RNA removal 3.1 Usage 3.2 Tips", " 3 Ambient RNA removal The cell suspension in single nucleus transcriptome sequencing often contains a low-to-moderate concentration of cell-free mRNA or other capturable features, leading to nonzero molecule counts in cell-free droplets. These ‘ambient’ molecules originate from sources such as ruptured or degraded cells, residual cytoplasmic debris (e.g., in snRNA-seq), or exogenous contaminants. This systematic background noise can introduce batch effects and result in spurious differential gene expression. To address this, we apply CellBender, a deep generative model that accurately distinguishes cell-containing droplets from cell-free ones. By learning the background noise profile, it provides end-to-end, noise-free quantification, enhancing the reliability of downstream analysis. 3.1 Usage In this projects, we apply CellBender (version 0.3.0) to process the ‘raw_feature_bc_matrix’ to remove empty droplets and counts due to ambient RNA molecules from the count matrices and estimate the true cells. Here is an example of one sample from adipose tissue. 3.1.1 Installation we installed CellBender (v0.3.0) in its own conda environment by following the protocol writtern by the developer 3.1.2 Getting started Activate the conda environment: system(&#39;conda activate cellbender-env&#39;) Run cellbender remove-backage using the command system(&#39;cd ./data&#39;) system(&#39;cellbender remove-background \\ --input ./raw_feature_bc_matrix.h5 \\ --output ./output/demo.h5 \\ --cuda &#39;) ## Warning in system(&quot;cellbender remove-background \\n --input ./raw_feature_bc_matrix.h5 \\n --output ./output/demo.h5 \\n ## --cuda &quot;): error in running command Perform per-cell quality control checks, and filter out dead / dying cells, as appropriate for your experiment 3.2 Tips "],["quality-control-and-doublet-removal.html", "4 Quality control and doublet removal", " 4 Quality control and doublet removal These individual samples from publicly available datasets were re-analyzed with Seurat (version 5.1.0) in R v4.3.1. Individual objects were created considering genes expressed in more than 3 cells, and cells with more than 200 genes expressed. Low-quality barcodes (nucleus) had less than 200 features or than 500 UMIs were excluded. Additionally, Mitochondrial content thresholds for exclusion were set at 5% (hypothalamus, adipose tissue and liver) and 10% (skeletal muscle). All samples were assessed for potential doublets using scDblFinder (version 1.16.0), and nucleus called as doublets were removed before further analyses.The command we use were as follows: "],["normalization-clustering-and-annotation.html", "5 Normalization, clustering and annotation", " 5 Normalization, clustering and annotation Gene-expression values were normalized using sctransform (v2). Principal component analysis (PCA) was carried out using the variable features for the SCT Assay Uniform Manifold Approximation and Projection (UMAP) analysis was performed to further reduce variation to two dimensions with ‘RunUMAP’ function with 25 to 40 principal components, and a resolution range from 0.6 to 2. These clusters were manually annotated based on differentially expressed genes generated from ‘FindAllMarkers’ function as well as the canonical marker genes from published literature. The command we use were as follows: "],["data-integration.html", "6 Data integration", " 6 Data integration After filtering, mitochondrial, ribosomal protein-coding and leukocyte antigen genes were removed from these 5 datasets. Batch effect were corrected by applying following integration tools: CCA and RPCA performed in the ‘IntegrateLayers’ function which is a streamlined integrative analysis from Seurat, Harmony (version 1.2.0) as well as scVI(version 1.1.2). Followed by the tutorials of each method, when applying RunHarmony, we used donor ID as integration variants and a theta of 0.6. We used all genes in scVI integration, and Seurat objects were transcribed into anndata objects using scfetch (version 0.5.0) in R with reticulate (1.37.0). The command we use were as follows: "],["benchmarking-analyses.html", "7 Benchmarking analyses", " 7 Benchmarking analyses In addition to identification of prominent marker genes in the integrated data, benchmarking included calculations of ARI coefficients, LISI scores kBET rates for integration across different donors by using benchmarking pipeline from scib-matrices (version 0.5.1) package. All the datasets were clustered well using the above method with refined resolution.The command we use were as follows: "],["reference.html", "8 Reference", " 8 Reference Massier, L., et al., An integrated single cell and spatial transcriptomic map of human white adipose tissue. Nature Communications, 2023. 14(1): p. 1438. Fleming, S.J., et al., Unsupervised removal of systematic background noise from droplet-based single-cell experiments using CellBender. Nature Methods, 2023. 20(9): p. 1323-1335. Hao, Y., et al., Dictionary learning for integrative, multimodal and scalable single-cell analysis. Nature Biotechnology, 2024. 42(2): p. 293-304. Germain P, L.A., Garcia Meixide C, Macnair W, Robinson M Doublet identification in single-cell sequencing data using scDblFinder. f1000research, 2022. Hafemeister, C. and R. Satija, Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression. Genome Biology, 2019. 20(1): p. 296. Aran, D., et al., Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage. Nature Immunology, 2019. 20(2): p. 163-172. Korsunsky, I., et al., Fast, sensitive and accurate integration of single-cell data with Harmony. Nature Methods, 2019. 16(12): p. 1289-1296. Luecken, M.D., et al., Benchmarking atlas-level data integration in single-cell genomics. Nature Methods, 2022. 19(1): p. 41-50. Yabing Song, J.G., Jianbin Wang, scfetch: an R package to access and format single-cell RNA sequencing datasets from public repositories. bioRxiv, 2023. Heumos, L., et al., Best practices for single-cell analysis across modalities. Nature Reviews Genetics, 2023. 24(8): p. 550-572. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
